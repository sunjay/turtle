language: rust
os:
  - linux
  - osx
rust:
  - stable
  - beta
  - nightly

script:
  # -D warnings denies all warnings so that we always know when some code
  # introduces new ones
  - RUSTFLAGS="-D warnings" cargo build --verbose --all
  # Make sure we can run on osx
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then cargo run --verbose --example runtest; fi
  - cargo test --verbose --features "test" --all
  - cargo doc --verbose --all
matrix:
  # Mark the build as finished even if the allow_failures builds
  # are still running
  fast_finish: true
  allow_failures:
    - rust: beta
    - rust: nightly
